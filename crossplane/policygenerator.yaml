apiVersion: policy.open-cluster-management.io/v1
kind: PolicyGenerator
metadata:
  name: policy-generator-crossplane
  labels:
    custom: crossplane-policies
placementBindingDefaults:
  name: crossplane-hub-policy
policyDefaults:
  pruneObjectBehavior: "DeleteAll"
  namespace: global-policies
  # Use an existing placement rule so that placement bindings can be consolidated
  placement:
    placementRulePath: ../placementrules/OCP-HUB/hub-placementrule.yaml
  remediationAction: enforce
  severity: medium
policies:
- name: policy-crossplane-helm-repo
  disabled: false
  manifests:
    - path: ./crossplane-helm-repo
- name: policy-crossplane-app-install
  disabled: false
  manifests:
    - path: ./crossplane-install-non-vault
    - path: ../placementrules/OCP-HUB/hub-placementrule.yaml
      patches:
        - apiVersion: apps.open-cluster-management.io/v1
          kind: PlacementRule
          metadata:
            name: hub-placementrule
            namespace: crossplane-system
            labels:
              app: crossplane
- name: policy-crossplane-providers
  disabled: false
  manifests:
    - path: ./crossplane-provider

    
